<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Embedded Variables | ngx_waf</title>
    <meta name="generator" content="VuePress 1.9.5">
    <link rel="icon" href="https://cdn.jsdelivr.net/gh/ADD-SP/ngx_waf@master/assets/logo.png">
    <meta name="description" content="A web application firewall module for nginx without complex configuration.&#39;">
    <meta name="robots" content="noindex, nofollow, noarchive, nosnippet, noimageindex, noodp, notranslate, max-video-preview:-1">
    
    <link rel="preload" href="/ngx_waf-docs/assets/css/0.styles.f8a1c8e0.css" as="style"><link rel="preload" href="/ngx_waf-docs/assets/js/app.943a444d.js" as="script"><link rel="preload" href="/ngx_waf-docs/assets/js/2.f9c18778.js" as="script"><link rel="preload" href="/ngx_waf-docs/assets/js/14.798d3ca4.js" as="script"><link rel="prefetch" href="/ngx_waf-docs/assets/js/10.98c2e16c.js"><link rel="prefetch" href="/ngx_waf-docs/assets/js/11.f274c773.js"><link rel="prefetch" href="/ngx_waf-docs/assets/js/12.8ff6e722.js"><link rel="prefetch" href="/ngx_waf-docs/assets/js/13.6fdee710.js"><link rel="prefetch" href="/ngx_waf-docs/assets/js/15.e9aa8d0c.js"><link rel="prefetch" href="/ngx_waf-docs/assets/js/16.f5728593.js"><link rel="prefetch" href="/ngx_waf-docs/assets/js/17.5f46a514.js"><link rel="prefetch" href="/ngx_waf-docs/assets/js/18.2bc72be3.js"><link rel="prefetch" href="/ngx_waf-docs/assets/js/19.074719a8.js"><link rel="prefetch" href="/ngx_waf-docs/assets/js/20.1adacd3f.js"><link rel="prefetch" href="/ngx_waf-docs/assets/js/21.a555c86b.js"><link rel="prefetch" href="/ngx_waf-docs/assets/js/22.3b6a833a.js"><link rel="prefetch" href="/ngx_waf-docs/assets/js/23.9488cd73.js"><link rel="prefetch" href="/ngx_waf-docs/assets/js/24.94433776.js"><link rel="prefetch" href="/ngx_waf-docs/assets/js/25.4ca25297.js"><link rel="prefetch" href="/ngx_waf-docs/assets/js/26.cf6c380d.js"><link rel="prefetch" href="/ngx_waf-docs/assets/js/27.ae83e9f3.js"><link rel="prefetch" href="/ngx_waf-docs/assets/js/28.7082b173.js"><link rel="prefetch" href="/ngx_waf-docs/assets/js/29.ed1e540c.js"><link rel="prefetch" href="/ngx_waf-docs/assets/js/3.1aa8173f.js"><link rel="prefetch" href="/ngx_waf-docs/assets/js/30.c1432ade.js"><link rel="prefetch" href="/ngx_waf-docs/assets/js/31.741aab39.js"><link rel="prefetch" href="/ngx_waf-docs/assets/js/32.fc8f7480.js"><link rel="prefetch" href="/ngx_waf-docs/assets/js/33.976437cf.js"><link rel="prefetch" href="/ngx_waf-docs/assets/js/34.0c10929c.js"><link rel="prefetch" href="/ngx_waf-docs/assets/js/35.edb5df3a.js"><link rel="prefetch" href="/ngx_waf-docs/assets/js/36.74f48504.js"><link rel="prefetch" href="/ngx_waf-docs/assets/js/37.feeb9ee4.js"><link rel="prefetch" href="/ngx_waf-docs/assets/js/38.d9bec507.js"><link rel="prefetch" href="/ngx_waf-docs/assets/js/39.31078091.js"><link rel="prefetch" href="/ngx_waf-docs/assets/js/4.53170c6b.js"><link rel="prefetch" href="/ngx_waf-docs/assets/js/40.2554457e.js"><link rel="prefetch" href="/ngx_waf-docs/assets/js/41.4339d6c6.js"><link rel="prefetch" href="/ngx_waf-docs/assets/js/42.a7868bbd.js"><link rel="prefetch" href="/ngx_waf-docs/assets/js/43.58caa08c.js"><link rel="prefetch" href="/ngx_waf-docs/assets/js/44.f861107c.js"><link rel="prefetch" href="/ngx_waf-docs/assets/js/45.4fc6eb6f.js"><link rel="prefetch" href="/ngx_waf-docs/assets/js/46.2c4c381f.js"><link rel="prefetch" href="/ngx_waf-docs/assets/js/47.01e5485c.js"><link rel="prefetch" href="/ngx_waf-docs/assets/js/48.74c45da6.js"><link rel="prefetch" href="/ngx_waf-docs/assets/js/49.44a9dcf4.js"><link rel="prefetch" href="/ngx_waf-docs/assets/js/5.11cf5e2d.js"><link rel="prefetch" href="/ngx_waf-docs/assets/js/50.a0d3e5ee.js"><link rel="prefetch" href="/ngx_waf-docs/assets/js/51.81462aa7.js"><link rel="prefetch" href="/ngx_waf-docs/assets/js/52.e6d8d09b.js"><link rel="prefetch" href="/ngx_waf-docs/assets/js/53.6c793198.js"><link rel="prefetch" href="/ngx_waf-docs/assets/js/54.19314ea9.js"><link rel="prefetch" href="/ngx_waf-docs/assets/js/55.2215402e.js"><link rel="prefetch" href="/ngx_waf-docs/assets/js/56.ca16527e.js"><link rel="prefetch" href="/ngx_waf-docs/assets/js/57.dd87040a.js"><link rel="prefetch" href="/ngx_waf-docs/assets/js/58.0e98077f.js"><link rel="prefetch" href="/ngx_waf-docs/assets/js/59.bdaa646d.js"><link rel="prefetch" href="/ngx_waf-docs/assets/js/6.7f9b813c.js"><link rel="prefetch" href="/ngx_waf-docs/assets/js/60.5d938afb.js"><link rel="prefetch" href="/ngx_waf-docs/assets/js/61.4b8bbb43.js"><link rel="prefetch" href="/ngx_waf-docs/assets/js/62.1c197855.js"><link rel="prefetch" href="/ngx_waf-docs/assets/js/63.d4c1311c.js"><link rel="prefetch" href="/ngx_waf-docs/assets/js/64.c99e4d08.js"><link rel="prefetch" href="/ngx_waf-docs/assets/js/65.0648bbd5.js"><link rel="prefetch" href="/ngx_waf-docs/assets/js/66.3a1f981c.js"><link rel="prefetch" href="/ngx_waf-docs/assets/js/67.dff59d33.js"><link rel="prefetch" href="/ngx_waf-docs/assets/js/68.03f1e681.js"><link rel="prefetch" href="/ngx_waf-docs/assets/js/7.a1c08f95.js"><link rel="prefetch" href="/ngx_waf-docs/assets/js/8.3e033ae5.js"><link rel="prefetch" href="/ngx_waf-docs/assets/js/9.aa55e2b8.js">
    <link rel="stylesheet" href="/ngx_waf-docs/assets/css/0.styles.f8a1c8e0.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/ngx_waf-docs/" class="home-link router-link-active"><!----> <span class="site-name">ngx_waf</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/ngx_waf-docs/practice/overview.html" class="nav-link">
  Best Practices
</a></div><div class="nav-item"><a href="/ngx_waf-docs/advance/upgrade.html" class="nav-link">
  Cross-version Upgrades
</a></div><div class="nav-item"><a href="/ngx_waf-docs/changes/overview.html" class="nav-link">
  CHANGES
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Languages</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/ngx_waf-docs/advance/variable.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  English
</a></li><li class="dropdown-item"><!----> <a href="/ngx_waf-docs/zh-cn/advance/variable.html" class="nav-link">
  简体中文
</a></li></ul></div></div> <a href="https://github.com/ADD-SP/ngx_waf/" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/ngx_waf-docs/practice/overview.html" class="nav-link">
  Best Practices
</a></div><div class="nav-item"><a href="/ngx_waf-docs/advance/upgrade.html" class="nav-link">
  Cross-version Upgrades
</a></div><div class="nav-item"><a href="/ngx_waf-docs/changes/overview.html" class="nav-link">
  CHANGES
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Languages</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/ngx_waf-docs/advance/variable.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  English
</a></li><li class="dropdown-item"><!----> <a href="/ngx_waf-docs/zh-cn/advance/variable.html" class="nav-link">
  简体中文
</a></li></ul></div></div> <a href="https://github.com/ADD-SP/ngx_waf/" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><a href="/ngx_waf-docs/guide/overview.html" class="sidebar-heading clickable"><span>Quick Start</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/ngx_waf-docs/advance/directive.html" class="sidebar-heading clickable open"><span>Advanced Guide</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/ngx_waf-docs/advance/directive.html" class="sidebar-link">Directive</a></li><li><a href="/ngx_waf-docs/advance/rule.html" class="sidebar-link">Rule Description</a></li><li><a href="/ngx_waf-docs/advance/priority.html" class="sidebar-link">Rule Priority</a></li><li><a href="/ngx_waf-docs/advance/variable.html" aria-current="page" class="active sidebar-link">Embedded Variables</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/ngx_waf-docs/advance/variable.html#waf-log" class="sidebar-link">$waf_log</a></li><li class="sidebar-sub-header"><a href="/ngx_waf-docs/advance/variable.html#waf-blocking-log" class="sidebar-link">$waf_blocking_log</a></li><li class="sidebar-sub-header"><a href="/ngx_waf-docs/advance/variable.html#waf-blocked" class="sidebar-link">$waf_blocked</a></li><li class="sidebar-sub-header"><a href="/ngx_waf-docs/advance/variable.html#waf-spend" class="sidebar-link">$waf_spend</a></li><li class="sidebar-sub-header"><a href="/ngx_waf-docs/advance/variable.html#waf-rule-type" class="sidebar-link">$waf_rule_type</a></li><li class="sidebar-sub-header"><a href="/ngx_waf-docs/advance/variable.html#waf-rule-details" class="sidebar-link">$waf_rule_details</a></li><li class="sidebar-sub-header"><a href="/ngx_waf-docs/advance/variable.html#waf-rate" class="sidebar-link">$waf_rate</a></li></ul></li><li><a href="/ngx_waf-docs/advance/log.html" class="sidebar-link">Log</a></li><li><a href="/ngx_waf-docs/advance/upgrade.html" class="sidebar-link">Cross-version Upgrades</a></li><li><a href="/ngx_waf-docs/advance/issue.html" class="sidebar-link">Known Issues</a></li></ul></section></li><li><a href="/ngx_waf-docs/roadmap/overview.html" class="sidebar-link">Roadmap (Advice Needed)</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="embedded-variables"><a href="#embedded-variables" class="header-anchor">#</a> Embedded Variables</h1> <p>When writing <code>nginx.conf</code>, some variables are inevitably needed. For example, <code>$remote_addr</code> can be used to get the client IP address.</p> <p>This module adds several available variables.</p> <div class="custom-block warning"><p class="custom-block-title">CAN NOT BE USED FOR DIRECTIVE `if`</p> <p>See <a href="/ngx_waf-docs/guide/faq.html#embedded-variables-and-directive-if">FAQ</a>.</p></div> <h2 id="waf-log"><a href="#waf-log" class="header-anchor">#</a> <code>$waf_log</code></h2> <p>Not an empty string if the firewall is checked in this request, otherwise an empty string. This variable is mainly used in the directive <code>access_log</code>, see <a href="/ngx_waf-docs/advance/log.html#customised-log-format">Customised Log Format</a>.</p> <h2 id="waf-blocking-log"><a href="#waf-blocking-log" class="header-anchor">#</a> <code>$waf_blocking_log</code></h2> <p>Not an empty string if this request was originally blocked by the module, and vice versa. This variable is mainly used in the directive <code>access_log</code>, see <a href="/ngx_waf-docs/advance/log.html#customised-log-format">Customised Log Format</a>.</p> <h2 id="waf-blocked"><a href="#waf-blocked" class="header-anchor">#</a> <code>$waf_blocked</code></h2> <p>Whether this request is intercepted by this module, if intercepted, its value is <code>'true'</code>, otherwise it is <code>'false'</code>.</p> <h2 id="waf-spend"><a href="#waf-spend" class="header-anchor">#</a> <code>$waf_spend</code></h2> <p>Indicates how much time (in milliseconds) this check took, retaining 5 decimal places, with rounding rules depending on the specific C standard library implementation.</p> <h2 id="waf-rule-type"><a href="#waf-rule-type" class="header-anchor">#</a> <code>$waf_rule_type</code></h2> <p>If a black and white list rule is in effect for this request, the value is the type of rule that triggered it. Here are the possible values. If no black and white list rule is in effect then the value is <code>''</code>.</p> <ul><li><code>'CC-DENY'</code></li> <li><code>'WHITE-IPV4'</code></li> <li><code>'WHITE-IPV6'</code></li> <li><code>'BLACK-IPV4'</code></li> <li><code>'BLACK-IPV6'</code></li> <li><code>'WHITE-URL'</code></li> <li><code>'BLACK-URL'</code></li> <li><code>'BLACK-ARGS'</code></li> <li><code>'BLACK-USER-AGENT'</code></li> <li><code>'WHITE-REFERER'</code></li> <li><code>'BLACK-REFERER'</code></li> <li><code>'BLACK-COOKIE'</code></li> <li><code>'BLACK-POST'</code></li> <li><code>'UNDER-ATTACK'</code></li> <li><code>'FAKE-BOT'</code></li> <li><code>'CAPTCHA'</code></li></ul> <h2 id="waf-rule-details"><a href="#waf-rule-details" class="header-anchor">#</a> <code>$waf_rule_details</code></h2> <p>If this request is blocked by this module, its value is the content of the specific rule triggered. If it is not blocked, its value is <code>''</code>.</p> <h2 id="waf-rate"><a href="#waf-rate" class="header-anchor">#</a> <code>$waf_rate</code></h2> <p>An integer that represents the number of accesses to the current IP in a cycle.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/ADD-SP/ngx_waf-docs/edit/master/docs/advance/variable.md" target="_blank" rel="noopener noreferrer">Help us improve this page!</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">1/10/2022, 3:38:27 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/ngx_waf-docs/advance/priority.html" class="prev">
        Rule Priority
      </a></span> <span class="next"><a href="/ngx_waf-docs/advance/log.html">
        Log
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/ngx_waf-docs/assets/js/app.943a444d.js" defer></script><script src="/ngx_waf-docs/assets/js/2.f9c18778.js" defer></script><script src="/ngx_waf-docs/assets/js/14.798d3ca4.js" defer></script>
  </body>
</html>
